!function(t,n){"use strict";"undefined"!=typeof module?module.exports=n(t):t.define?t.define("$mask",n):t.angular?t.angular.module("jengine.mask",[]).constant("$mask",n()):t.$storage||(t.$mask=n())}(this,function(t){"use strict";function n(t,n){for(var r=[],e=t.length>n.length?t.length:n.length,a=0;e>a;a++)a<t.length&&(t[a]instanceof Array?r=r.concat(t[a]):r.push(t[a])),a<n.length&&(n[a]instanceof Array?r=r.concat(n[a]):r.push(n[a]));return r}function r(t,n){return t+u[n]+(t?"?":"")}function e(){return null}function a(t){return t.split("").map(e)}function s(t){var e=t.split(/\{[^\}]+\}/),s=t.match(/\{([^\}]+)\}/g);if(!s)throw new Error("wrong mask");s=s.map(function(t){return t.substr(1,t.length-2)}),this.matchRE=new RegExp("^"+s.join("").split("").reduce(r,"")+"$"),this.maskArray=n(e,s.map(a))}function i(t){return new s(t)}var u={9:"(\\d)",a:"([a-z])",A:"([A-Z])","Ã¢":"([a-zA-Z])"};return s.prototype.eval=function(t){var n=this.match(t);if(!n)throw new Error("value mismatch");for(var r="",e=0,a=0,s=this.maskArray.length;s>a;a++)if(null===this.maskArray[a]){if(!t.charAt(e))return r;r+=t.charAt(e++)}else r+=this.maskArray[a];return r},s.prototype.match=function(t){var n=t.match(this.matchRE);return n&&n.slice(1)},i.MaskParser=s,i});